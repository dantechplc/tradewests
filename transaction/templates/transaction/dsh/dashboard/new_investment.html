{% extends 'transaction/dsh/base.html' %}
{% load static %}
{% block title %}Tradewests | INVESTMENT{% endblock %}

{% block content %}
<div id="content-page" class="content-page">
    <div class="container-fluid">

        <!-- PAGE TITLE -->
        <div class="row mb-4">
            <div class="col-12 text-center">
                <h3 class="font-weight-bold">Investment Plans</h3>
                <p class="text-muted">Select a category to view available plans</p>
            </div>
        </div>

        <!-- ðŸ”¥ CATEGORY TOGGLES -->
        <div class="row mb-4">
            <div class="col-12 text-center">
                {% for category in categories %}
                <button
                    class="category-toggle {% if forloop.first %}active{% endif %}"
                    data-target="cat-{{ category.id }}">
                    {{ category.name }}
                </button>
                {% endfor %}
            </div>
        </div>

        <!-- ðŸ”¥ INVESTMENT GROUPS -->
        {% for category in categories %}
        <div class="row investment-group"
             id="cat-{{ category.id }}"
             {% if not forloop.first %}style="display:none;"{% endif %}>

            <!-- ðŸ”¥ PROMO FIRST -->
            {% for investment in investments %}
                {% if investment.category_id == category.id and investment.is_promo %}
                <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                    <div class="iq-card investment-card promo">
                        <div class="iq-card-body text-center rounded position-relative">

                            <div class="promo-badge">ðŸ”¥ PROMO</div>

                            {% if investment.image %}
                            <div class="mb-3">
                                <img src="{{ investment.image.url }}"
                                     width="90" height="90"
                                     style="object-fit:contain;">
                            </div>
                            {% endif %}

                            <h4 class="text-uppercase font-weight-bold text-white">
                                {{ investment.name }}
                            </h4>

                            <form method="post">
                                {% csrf_token %}
                                <input type="hidden" name="investment_name" value="{{ investment.name }}">

                                <ul class="list-unstyled mb-4 text-white text-left benefits">
                                    {% for benefit in investment.benefits.all %}
                                        <li class="font-weight-bold">{{ benefit.name }}</li>
                                    {% endfor %}
                                </ul>

                                <button type="submit" class="btn select-btn promo-btn">
                                    Select Promo Plan
                                </button>
                            </form>

                        </div>
                    </div>
                </div>
                {% endif %}
            {% endfor %}

            <!-- âœ… NORMAL PLANS -->
            {% for investment in investments %}
                {% if investment.category_id == category.id and not investment.is_promo %}
                <div class="col-lg-4 col-md-6 col-sm-12 mb-4">
                    <div class="iq-card investment-card">
                        <div class="iq-card-body text-center rounded">

                            {% if investment.image %}
                            <div class="mb-3">
                                <img src="{{ investment.image.url }}"
                                     width="90" height="90"
                                     style="object-fit:contain;">
                            </div>
                            {% endif %}

                            <h4 class="text-uppercase font-weight-bold text-white">
                                {{ investment.name }}
                            </h4>

                            <form method="post">
                                {% csrf_token %}
                                <input type="hidden" name="investment_name" value="{{ investment.name }}">

                                <ul class="list-unstyled mb-4 text-white text-left benefits">
                                    {% for benefit in investment.benefits.all %}
                                        <li class="font-weight-bold">{{ benefit.name }}</li>
                                    {% endfor %}
                                </ul>

                                <button type="submit" class="btn select-btn">
                                    Select Plan
                                </button>
                            </form>

                        </div>
                    </div>
                </div>
                {% endif %}
            {% endfor %}

        </div>
        {% endfor %}

    </div>
</div>

<!-- ðŸ”¥ TOGGLE SCRIPT -->
<script>
document.addEventListener("DOMContentLoaded", function () {

    const toggles = document.querySelectorAll(".category-toggle");
    const groups = document.querySelectorAll(".investment-group");

    toggles.forEach(btn => {
        btn.addEventListener("click", function () {

            toggles.forEach(b => b.classList.remove("active"));
            groups.forEach(g => g.style.display = "none");

            this.classList.add("active");
            document.getElementById(this.dataset.target).style.display = "flex";
        });
    });

});
</script>

<style>
/* ðŸ”˜ Category toggles */
.category-toggle {
    background:#1b2a3a;
    color:white;
    border:none;
    padding:12px 26px;
    margin:5px;
    border-radius:30px;
    cursor:pointer;
    font-weight:bold;
    transition:all 0.3s ease;
}
.category-toggle.active {
    background:#471396;
}

/* ðŸ“¦ Cards */
.investment-card {
    background:#1b2a3a;
    border-radius:16px;
    transition:all 0.3s ease;
    height:100%;
}
.investment-card:hover {
    transform:translateY(-8px);
    box-shadow:0 14px 32px rgba(0,0,0,0.3);
}

/* ðŸ”¥ Promo card */
.investment-card.promo {
    background:linear-gradient(135deg,#ff416c,#ff4b2b);
    border:2px solid rgba(255,255,255,0.9);
}

/* ðŸŽ€ Promo ribbon */
.promo-badge {
    position:absolute;
    top:-12px;
    right:-12px;
    background:white;
    color:#ff416c;
    font-weight:900;
    padding:6px 16px;
    border-radius:25px;
    font-size:12px;
    transform:rotate(14deg);
    box-shadow:0 6px 12px rgba(0,0,0,0.35);
}

/* âœ… Benefits */
.benefits li {
    margin-bottom:8px;
    display:flex;
    gap:6px;
}
.benefits li::before {
    content:"âœ”";
    color:#7cffcb;
    font-weight:bold;
}

/* ðŸš€ Buttons */
.select-btn {
    width:100%;
    padding:14px;
    border-radius:30px;
    border:none;
    font-weight:bold;
    background:#471396;
    color:white;
    transition:all 0.3s ease;
}
.select-btn:hover {
    background:#5f2de0;
}

/* ðŸ”¥ Promo button */
.promo-btn {
    background:#fff;
    color:#ff416c;
}
.promo-btn:hover {
    background:#ffe3ea;
}

/* ðŸ“± Mobile */
@media(max-width:576px) {
    .investment-group {
        justify-content:center;
    }
}
</style>
{% endblock %}
